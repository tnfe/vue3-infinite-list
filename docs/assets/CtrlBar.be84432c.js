var de=Object.defineProperty,ue=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var $=(t,e,n)=>e in t?de(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,v=(t,e)=>{for(var n in e||(e={}))fe.call(e,n)&&$(t,n,e[n]);if(j)for(var n of j(e))me.call(e,n)&&$(t,n,e[n]);return t},M=(t,e)=>ue(t,ce(e));var f=(t,e,n)=>($(t,typeof e!="symbol"?e+"":e,n),n);import{_ as J}from"./main.398c6e87.js";import{d as K,j as N,k as X,l as he,m as Se,n as ge,q as b,o as w,c as O,b as T,F as Ie,s as ve,u as R,v as ze,x as ye,r as Y,e as W,y as Ae,w as Ce,p as _e,a as Me}from"./vendor.5d83dfb2.js";const Ee="auto",Q="start",Ne="center",be="end",L="vertical",D="horizontal",Pe="observed",P="requested",we={[L]:"scrollTop",[D]:"scrollLeft"},Oe={[L]:"height",[D]:"width"},Te={[L]:"top",[D]:"left"},Le={overflow:"auto",willChange:"transform",WebkitOverflowScrolling:"touch"},Z={position:"relative",overflow:"hidden",width:"100%",minHeight:"100%"},pe={position:"absolute",left:0,width:"100%",height:"100%"};class xe{constructor({itemCount:e,itemSizeGetter:n,estimatedItemSize:i}){f(this,"itemSizeGetter");f(this,"itemCount");f(this,"estimatedItemSize");f(this,"lastMeasuredIndex");f(this,"itemSizeAndPositionData");this.itemSizeGetter=n,this.itemCount=e,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1}updateConfig({itemCount:e,estimatedItemSize:n}){this.itemCount=e,this.estimatedItemSize=n}getLastMeasuredIndex(){return this.lastMeasuredIndex}destroy(){for(let e in this.itemSizeAndPositionData)delete this.itemSizeAndPositionData[e]}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);if(e>this.lastMeasuredIndex){const n=this.getSizeAndPositionOfLastMeasuredItem();let i=n.offset+n.size;for(let o=this.lastMeasuredIndex+1;o<=e;o++){const r=this.itemSizeGetter(o);if(r==null||isNaN(r))throw Error(`Invalid size returned for index ${o} of value ${r}`);this.itemSizeAndPositionData[o]={offset:i,size:r},i+=r}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=Q,containerSize:n,currentOffset:i,targetIndex:o}){if(n<=0)return 0;const r=this.getSizeAndPositionForIndex(o),l=r.offset,c=l-n+r.size;let a;switch(e){case be:a=c;break;case Ne:a=l-(n-r.size)/2;break;case Q:a=l;break;default:a=Math.max(c,Math.min(l,i))}const d=this.getTotalSize();return Math.max(0,Math.min(d-n,a))}getVisibleRange({containerSize:e,offset:n,overscanCount:i}){if(this.getTotalSize()===0)return{};const r=n+e;let l=this.findNearestItem(n);if(typeof l=="undefined")throw Error(`Invalid offset ${n} specified`);const c=this.getSizeAndPositionForIndex(l);n=c.offset+c.size;let a=l;for(;n<r&&a<this.itemCount-1;)a++,n+=this.getSizeAndPositionForIndex(a).size;return i&&(l=Math.max(0,l-i),a=Math.min(a+i,this.itemCount-1)),{start:l,stop:a}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const n=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return n.offset>=e?this.binarySearch({high:i,low:0,offset:e}):this.exponentialSearch({index:i,offset:e})}binarySearch({low:e,high:n,offset:i}){let o=0,r=0;for(;e<=n;){if(o=e+Math.floor((n-e)/2),r=this.getSizeAndPositionForIndex(o).offset,r===i)return o;r<i?e=o+1:r>i&&(n=o-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:n}){let i=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<n;)e+=i,i*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:n})}}class Ve{addEventListener(e,n,i){return e.addEventListener?e.addEventListener(n,i,!1):e.attachEvent?e.attachEvent(n,i):e["on"+n]=i}removeEventListener(e,n,i){return e.removeEventListener?e.removeEventListener(n,i,!1):e.detachEvent?e.detachEvent(n,i):e["on"+n]=null}isArray(e){return Object.prototype.toString.call(e)==="[object Array]"}randomColor(){return"#"+("00000"+(Math.random()*16777216<<0).toString(16)).slice(-6)}isPureNumber(e){return typeof e=="number"||!e}}class $e{constructor(){f(this,"items",[]);f(this,"offset",0);f(this,"data",null);f(this,"start",0);f(this,"stop",0);f(this,"total",0)}toString(){return`start:${this.start} stop:${this.stop} total:${this.total} offset:${this.offset}`}}const Re=K({name:"InfiniteList",props:{scrollDirection:{type:String,default:L},scrollToAlignment:{type:String,default:Ee},overscanCount:{type:Number,default:4},itemSize:{type:null,required:!0},data:{type:[Array,null],default:[],required:!0},unit:{type:String,default:"px"},width:{type:[Number,String]},height:{type:[Number,String]},debug:{type:Boolean,default:!1},scrollOffset:Number,scrollToIndex:Number,estimatedItemSize:Number},setup(t,{attrs:e,slots:n,emit:i}){let o=N(null),r=N(null),l=N(null),c=N(null),a=[],d,p,z,m,y={};const{itemSize:h,scrollDirection:k,scrollToIndex:Ye}=X(t),A=new Ve,S=he(new $e),ee=s=>{s+=S.start;const u=y[s];if(u)return u;const{size:g,offset:ae}=m.getSizeAndPositionForIndex(s),le=t.debug?{backgroundColor:A.randomColor()}:null;return y[s]=M(v(v({},pe),le),{[E()]:I(g),[Te[t.scrollDirection]]:I(ae)})},te=()=>{se(),A.addEventListener(o.value,"scroll",F),d=t.scrollOffset||t.scrollToIndex!=null&&V(t.scrollToIndex)||0,z=P,setTimeout(()=>{t.scrollOffset!=null?x(t.scrollOffset):t.scrollToIndex!=null&&x(V(t.scrollToIndex))},0),q(),C()},F=s=>{const u=ie();u<0||d===u||s.target!==o.value||(d=u,z=Pe,C())},C=()=>{const{start:s,stop:u}=m.getVisibleRange({containerSize:B()||0,offset:d||0,overscanCount:t.overscanCount});if(typeof s!="undefined"&&typeof u!="undefined"){a.length=0;for(let g=s;g<=u;g++)a.push(t.data[g]);S.start=s,S.stop=u,S.offset=d,S.items=a,S.total=_(),A.isPureNumber(h.value)||(c.value=M(v({},Z),{[E()]:I(m.getTotalSize())})),t.debug&&console.log(S.toString())}ne()},x=s=>{o.value[G()]=s,p=s},ne=()=>{p!==d&&z===P&&x(d)},se=()=>(m||(m=new xe({itemCount:_(),itemSizeGetter:s=>oe(s),estimatedItemSize:U()})),m),ie=()=>o.value[G()],E=()=>Oe[k.value],B=()=>t[E()],G=()=>we[k.value],V=(s,u=t.scrollToAlignment,g=_())=>((s<0||s>=g)&&(s=0),m.getUpdatedOffsetForIndex({align:t.scrollToAlignment,containerSize:B(),currentOffset:d||0,targetIndex:s})),oe=s=>typeof h.value=="function"?h.value(s):A.isArray(h.value)?h.value[s]:h.value,_=()=>t.data?t.data.length:0,U=()=>t.estimatedItemSize||typeof h.value=="number"&&h.value||50,re=(s=0)=>{y={},m.resetItem(s)},I=s=>typeof s=="string"?s:s+t.unit,q=()=>{l.value=M(v({},Le),{height:I(t.height),width:I(t.width)}),c.value=M(v({},Z),{[E()]:I(m.getTotalSize())})},H=()=>{for(let s in y)delete y[s]};return Se(()=>setTimeout(te)),ge(()=>{H(),m.destroy(),A.removeEventListener(o.value,"scroll",F)}),b(()=>t.debug,(s,u)=>H()),b(()=>t.data,(s,u)=>{m.updateConfig({itemCount:_(),estimatedItemSize:U()}),p=null,re(),q(),setTimeout(C,0)}),b(()=>t.scrollOffset,(s,u)=>{d=t.scrollOffset||0,z=P,C()}),b(()=>t.scrollToIndex,(s,u)=>{d=V(t.scrollToIndex,t.scrollToAlignment,_()),z=P,C()}),{rootNode:o,innerNode:r,warpStyle:l,innerStyle:c,getItemStyle:ee,event:S}}});function De(t,e,n,i,o,r){var l;return w(),O("div",{ref:"rootNode",style:R(t.warpStyle)},[T("div",{ref:"innerNode",style:R(t.innerStyle)},[(w(!0),O(Ie,null,ve((l=t.event)==null?void 0:l.items,(c,a)=>{var d;return w(),O("div",{style:R(t.getItemStyle(a)),key:((d=t.event)==null?void 0:d.start)+a,class:"vue3-infinite-list"},[ze(t.$slots,"default",{event:t.event,item:c,index:t.event.start+a})],4)}),128))],4)],4)}var Je=J(Re,[["render",De]]);const ke={generateData(t=1e5,e=-1){const n=[],i=ke.random(t,e);for(let o=0;o<i;o++)n.push({title:o,msg:"hello wrold"});return n},clone(t){let e=[];for(let n=0;n<t.length;n++)e.push(t[n]);return e},random(t,e){return e<=0&&(e=t),Math.floor(Math.random()*(e-t+1)+t)}};const Fe=K({name:"CtrlBar",props:{event:null,modelValue:{type:Boolean,default:!1},link:String},setup(t,{emit:e}){const{link:n,event:i}=X(t);return{model:ye({get(){return t.modelValue},set(r){return e("update:modelValue",r)}}),event:i,link:n}}}),Be=t=>(_e("data-v-efe3ab68"),t=t(),Me(),t),Ge={class:"ctrl"},Ue={class:"clist"},qe=Be(()=>T("span",{class:"title"},"Debug: ",-1)),He=["href"];function je(t,e,n,i,o,r){const l=Y("el-switch"),c=Y("el-button");return w(),O("div",Ge,[T("div",Ue,[qe,W(l,{modelValue:t.model,"onUpdate:modelValue":e[0]||(e[0]=a=>t.model=a),class:"ml-2","active-color":"#ff4949","inactive-color":"#666"},null,8,["modelValue"]),Ae("",!0),W(c,{type:"primary",style:{float:"right"},class:"linkbtn"},{default:Ce(()=>[T("a",{href:t.link,target:"_blank"},"view code",8,He)]),_:1})])])}var Ke=J(Fe,[["render",je],["__scopeId","data-v-efe3ab68"]]);export{Ke as C,Je as I,ke as a};
